<Window x:Class="WeatherApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="天気予報" Height="800" Width="1400"
        Background="#0a0e27"
        WindowStyle="None"
        ResizeMode="CanResize"
        AllowsTransparency="True">

    <Window.Resources>
        <!-- グラデーションブラシ -->
        <LinearGradientBrush x:Key="PrimaryGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#667eea" Offset="0"/>
            <GradientStop Color="#764ba2" Offset="0.5"/>
            <GradientStop Color="#f093fb" Offset="1"/>
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="CardGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#1a1f3a" Offset="0"/>
            <GradientStop Color="#2a2f4a" Offset="1"/>
        </LinearGradientBrush>

        <!-- グラスモーフィズム風カードスタイル -->
        <Style x:Key="GlassCard" TargetType="Border">
            <Setter Property="Background">
                <Setter.Value>
                    <SolidColorBrush Color="#1a1f3a" Opacity="0.6"/>
                </Setter.Value>
            </Setter>
            <Setter Property="CornerRadius" Value="20"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush">
                <Setter.Value>
                    <SolidColorBrush Color="#ffffff" Opacity="0.1"/>
                </Setter.Value>
            </Setter>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#000" BlurRadius="30" ShadowDepth="0" Opacity="0.5"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ホバーエフェクト付きボタンスタイル -->
        <Style x:Key="LocationButton" TargetType="Button">
            <Setter Property="Background" Value="#667eea"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="10" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#7c8ef5"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- テキストスタイル -->
        <Style x:Key="HeaderText" TargetType="TextBlock">
            <Setter Property="FontSize" Value="32"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>

        <Style x:Key="SubHeaderText" TargetType="TextBlock">
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="Foreground" Value="#B0B0B0"/>
        </Style>

        <Style x:Key="TempText" TargetType="TextBlock">
            <Setter Property="FontSize" Value="96"/>
            <Setter Property="FontWeight" Value="Thin"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>
    </Window.Resources>

    <Border CornerRadius="25" Background="#0a0e27" BorderBrush="#2a2f4a" BorderThickness="1">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- 背景アニメーション用グラデーション -->
            <Border Grid.Row="0" Grid.RowSpan="2" CornerRadius="25">
                <Border.Background>
                    <RadialGradientBrush>
                        <GradientStop Color="#667eea" Offset="0"/>
                        <GradientStop Color="#0a0e27" Offset="1"/>
                    </RadialGradientBrush>
                </Border.Background>
                <Border.OpacityMask>
                    <RadialGradientBrush Center="0.3,0.3" RadiusX="0.8" RadiusY="0.8">
                        <GradientStop Color="#40ffffff" Offset="0"/>
                        <GradientStop Color="#00ffffff" Offset="1"/>
                    </RadialGradientBrush>
                </Border.OpacityMask>
            </Border>

            <!-- ヘッダー -->
            <Border Grid.Row="0" Padding="40,30" Background="#10131f">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Orientation="Horizontal">
                        <TextBlock Text="⛅" FontSize="42" VerticalAlignment="Center" Margin="0,0,15,0"/>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="Weather Forecast" FontSize="28" FontWeight="Bold" Foreground="White"/>
                            <TextBlock Text="リアルタイム天気情報" FontSize="14" Foreground="#667eea" Margin="0,5,0,0"/>
                        </StackPanel>
                    </StackPanel>

                    <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                        <Button x:Name="RefreshButton" Content="🔄 更新" Style="{StaticResource LocationButton}" Margin="0,0,10,0" Click="OnRefreshClicked"/>
                        <Button x:Name="SettingsButton" Content="⚙ 設定" Style="{StaticResource LocationButton}" Click="OnSettingsClicked"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- メインコンテンツ -->
            <Grid Grid.Row="1" Margin="40,20,40,40">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*"/>
                    <ColumnDefinition Width="20"/>
                    <ColumnDefinition Width="3*"/>
                </Grid.ColumnDefinitions>

                <!-- 左側: 地図選択エリア -->
                <Border Grid.Column="0" Style="{StaticResource GlassCard}" Padding="30">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Text="📍 場所を選択" Style="{StaticResource HeaderText}" Margin="0,0,0,20"/>

                        <!-- 日本地図エリア -->
                        <Border Grid.Row="1" Background="#0f1428" CornerRadius="15" Padding="20">
                            <Viewbox Stretch="Uniform">
                                <Canvas Width="400" Height="600" ClipToBounds="True">
                                    <!-- 背景の日本列島シルエット（SVG風） -->
                                    <Path Fill="#1a2040" Stroke="#667eea" StrokeThickness="2" Opacity="0.3"
                                          Data="M 280,80 L 320,85 L 330,100 L 340,120 L 330,140 L 310,150 L 290,145 L 270,135 L 260,120 L 250,100 L 260,85 Z
                                                M 285,160 L 295,165 L 305,180 L 310,200 L 315,220 L 318,250 L 320,280 L 315,300 L 305,310 L 295,305 L 285,295 L 280,275 L 278,250 L 280,220 L 282,190 L 283,170 Z
                                                M 265,310 L 275,315 L 285,325 L 295,340 L 300,355 L 298,370 L 290,380 L 275,375 L 260,365 L 250,350 L 248,335 L 255,320 Z
                                                M 210,340 L 230,345 L 245,355 L 255,370 L 260,385 L 255,400 L 240,405 L 220,400 L 205,390 L 195,375 L 195,360 L 200,345 Z
                                                M 180,360 L 200,365 L 215,375 L 225,390 L 230,410 L 225,430 L 210,440 L 190,435 L 175,425 L 165,410 L 165,390 L 170,375 Z
                                                M 130,395 L 155,400 L 170,415 L 180,435 L 185,460 L 180,485 L 165,500 L 145,495 L 125,480 L 110,460 L 105,435 L 110,415 Z
                                                M 110,520 L 130,525 L 145,540 L 150,560 L 145,575 L 130,580 L 115,575 L 105,560 L 100,545 Z"/>

                                    <!-- 北海道 -->
                                    <Button Canvas.Left="230" Canvas.Top="50" Width="120" Height="100"
                                            Style="{StaticResource LocationButton}" Content="北海道" FontSize="16" FontWeight="Bold"
                                            Click="OnRegionSelected" Tag="北海道">
                                        <Button.RenderTransform>
                                            <RotateTransform Angle="-5" CenterX="60" CenterY="50"/>
                                        </Button.RenderTransform>
                                    </Button>

                                    <!-- 東北 -->
                                    <Button Canvas.Left="260" Canvas.Top="170" Width="85" Height="140"
                                            Style="{StaticResource LocationButton}" Content="東北" FontSize="15" FontWeight="Bold"
                                            Click="OnRegionSelected" Tag="東北">
                                        <Button.RenderTransform>
                                            <RotateTransform Angle="3" CenterX="42" CenterY="70"/>
                                        </Button.RenderTransform>
                                    </Button>

                                    <!-- 関東 -->
                                    <Button Canvas.Left="265" Canvas.Top="315" Width="90" Height="75"
                                            Style="{StaticResource LocationButton}" Content="関東" FontSize="15" FontWeight="Bold"
                                            Background="#f093fb" Click="OnRegionSelected" Tag="関東">
                                        <Button.RenderTransform>
                                            <RotateTransform Angle="8" CenterX="45" CenterY="37"/>
                                        </Button.RenderTransform>
                                    </Button>

                                    <!-- 中部 -->
                                    <Button Canvas.Left="190" Canvas.Top="305" Width="95" Height="90"
                                            Style="{StaticResource LocationButton}" Content="中部" FontSize="15" FontWeight="Bold"
                                            Click="OnRegionSelected" Tag="中部">
                                        <Button.RenderTransform>
                                            <RotateTransform Angle="-8" CenterX="47" CenterY="45"/>
                                        </Button.RenderTransform>
                                    </Button>

                                    <!-- 近畿 -->
                                    <Button Canvas.Left="170" Canvas.Top="365" Width="75" Height="70"
                                            Style="{StaticResource LocationButton}" Content="近畿" FontSize="14" FontWeight="Bold"
                                            Click="OnRegionSelected" Tag="近畿">
                                        <Button.RenderTransform>
                                            <RotateTransform Angle="5" CenterX="37" CenterY="35"/>
                                        </Button.RenderTransform>
                                    </Button>

                                    <!-- 中国 -->
                                    <Button Canvas.Left="95" Canvas.Top="370" Width="95" Height="65"
                                            Style="{StaticResource LocationButton}" Content="中国" FontSize="14" FontWeight="Bold"
                                            Click="OnRegionSelected" Tag="中国">
                                        <Button.RenderTransform>
                                            <RotateTransform Angle="-3" CenterX="47" CenterY="32"/>
                                        </Button.RenderTransform>
                                    </Button>

                                    <!-- 四国 -->
                                    <Button Canvas.Left="130" Canvas.Top="430" Width="85" Height="55"
                                            Style="{StaticResource LocationButton}" Content="四国" FontSize="14" FontWeight="Bold"
                                            Click="OnRegionSelected" Tag="四国">
                                        <Button.RenderTransform>
                                            <RotateTransform Angle="-12" CenterX="42" CenterY="27"/>
                                        </Button.RenderTransform>
                                    </Button>

                                    <!-- 九州 -->
                                    <Button Canvas.Left="50" Canvas.Top="420" Width="95" Height="110"
                                            Style="{StaticResource LocationButton}" Content="九州" FontSize="15" FontWeight="Bold"
                                            Click="OnRegionSelected" Tag="九州">
                                        <Button.RenderTransform>
                                            <RotateTransform Angle="-15" CenterX="47" CenterY="55"/>
                                        </Button.RenderTransform>
                                    </Button>

                                    <!-- 沖縄 -->
                                    <Button Canvas.Left="65" Canvas.Top="530" Width="70" Height="45"
                                            Style="{StaticResource LocationButton}" Content="沖縄" FontSize="13" FontWeight="Bold"
                                            Click="OnRegionSelected" Tag="沖縄">
                                        <Button.RenderTransform>
                                            <RotateTransform Angle="-25" CenterX="35" CenterY="22"/>
                                        </Button.RenderTransform>
                                    </Button>

                                    <!-- 装飾的な点（主要都市位置マーカー） -->
                                    <Ellipse Canvas.Left="295" Canvas.Top="350" Width="8" Height="8" Fill="#f093fb" Opacity="0.8"/>
                                    <Ellipse Canvas.Left="190" Canvas.Top="395" Width="8" Height="8" Fill="#667eea" Opacity="0.8"/>
                                    <Ellipse Canvas.Left="220" Canvas.Top="355" Width="8" Height="8" Fill="#667eea" Opacity="0.8"/>
                                    <Ellipse Canvas.Left="85" Canvas.Top="470" Width="8" Height="8" Fill="#667eea" Opacity="0.8"/>
                                </Canvas>
                            </Viewbox>
                        </Border>

                        <!-- 主要都市リスト -->
                        <StackPanel Grid.Row="2" Margin="0,20,0,0">
                            <TextBlock Text="主要都市" FontSize="16" FontWeight="SemiBold" Foreground="#B0B0B0" Margin="0,0,0,10"/>
                            <WrapPanel>
                                <Button Content="東京" Style="{StaticResource LocationButton}" Margin="0,0,8,8" Background="#f093fb" Click="OnCitySelected" Tag="東京"/>
                                <Button Content="大阪" Style="{StaticResource LocationButton}" Margin="0,0,8,8" Click="OnCitySelected" Tag="大阪"/>
                                <Button Content="名古屋" Style="{StaticResource LocationButton}" Margin="0,0,8,8" Click="OnCitySelected" Tag="名古屋"/>
                                <Button Content="福岡" Style="{StaticResource LocationButton}" Margin="0,0,8,8" Click="OnCitySelected" Tag="福岡"/>
                                <Button Content="札幌" Style="{StaticResource LocationButton}" Margin="0,0,8,8" Click="OnCitySelected" Tag="札幌"/>
                                <Button Content="仙台" Style="{StaticResource LocationButton}" Margin="0,0,8,8" Click="OnCitySelected" Tag="仙台"/>
                            </WrapPanel>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- 右側: 天気情報エリア -->
                <ScrollViewer Grid.Column="2" VerticalScrollBarVisibility="Auto">
                    <StackPanel>

                        <!-- 現在の天気 - 大型カード -->
                        <Border Style="{StaticResource GlassCard}" Padding="40" Margin="0,0,0,20">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <!-- ヘッダー -->
                                <Grid Grid.Row="0" Margin="0,0,0,30">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding CurrentWeather.LocationName}" FontSize="36" FontWeight="Bold" Foreground="White"/>
                                            <TextBlock Text="{Binding CurrentWeather.Region, StringFormat=' ({0})'}" FontSize="24" FontWeight="Normal" Foreground="#B0B0B0" VerticalAlignment="Bottom" Margin="10,0,0,4"/>
                                        </StackPanel>
                                        <TextBlock FontSize="16" Foreground="#B0B0B0" Margin="0,8,0,0">
                                            <Run Text="{Binding CurrentWeather.UpdateTime, StringFormat='yyyy年MM月dd日 HH:mm 更新', Mode=OneWay}"/>
                                        </TextBlock>
                                    </StackPanel>

                                    <TextBlock Grid.Column="1" Text="{Binding CurrentWeather.WeatherIcon}" FontSize="80" VerticalAlignment="Center"/>
                                </Grid>

                                <!-- 温度表示 -->
                                <Grid Grid.Row="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding CurrentWeather.Temperature}" Style="{StaticResource TempText}"/>
                                            <TextBlock Text="°C" FontSize="48" Foreground="White" VerticalAlignment="Top" Margin="5,20,0,0"/>
                                        </StackPanel>
                                        <TextBlock Text="{Binding CurrentWeather.Condition}" FontSize="28" Foreground="#B0B0B0" Margin="0,10,0,0"/>
                                        <TextBlock FontSize="18" Foreground="#808080" Margin="0,5,0,0">
                                            <Run Text="体感温度 "/>
                                            <Run Text="{Binding CurrentWeather.FeelsLike}"/>
                                            <Run Text="°C"/>
                                        </TextBlock>
                                    </StackPanel>

                                    <!-- 詳細情報グリッド -->
                                    <UniformGrid Grid.Column="1" Rows="2" Columns="2" Margin="60,0,0,0">
                                        <!-- 湿度 -->
                                        <Border Background="#1a1f3a" CornerRadius="15" Padding="20" Margin="5">
                                            <StackPanel>
                                                <TextBlock Text="💧" FontSize="32"/>
                                                <TextBlock Text="湿度" Foreground="#B0B0B0" FontSize="14" Margin="0,8,0,0"/>
                                                <TextBlock Foreground="White" FontSize="32" FontWeight="Bold" Margin="0,5,0,0">
                                                    <Run Text="{Binding CurrentWeather.Humidity}"/>
                                                    <Run Text="%"/>
                                                </TextBlock>
                                            </StackPanel>
                                        </Border>

                                        <!-- 風速 -->
                                        <Border Background="#1a1f3a" CornerRadius="15" Padding="20" Margin="5">
                                            <StackPanel>
                                                <TextBlock Text="💨" FontSize="32"/>
                                                <TextBlock Text="風速" Foreground="#B0B0B0" FontSize="14" Margin="0,8,0,0"/>
                                                <TextBlock Foreground="White" FontSize="28" FontWeight="Bold" Margin="0,5,0,0">
                                                    <Run Text="{Binding CurrentWeather.WindSpeed}"/>
                                                    <Run Text=" m/s"/>
                                                </TextBlock>
                                            </StackPanel>
                                        </Border>

                                        <!-- 降水確率 -->
                                        <Border Background="#1a1f3a" CornerRadius="15" Padding="20" Margin="5">
                                            <StackPanel>
                                                <TextBlock Text="☔" FontSize="32"/>
                                                <TextBlock Text="降水確率" Foreground="#B0B0B0" FontSize="14" Margin="0,8,0,0"/>
                                                <TextBlock Foreground="White" FontSize="32" FontWeight="Bold" Margin="0,5,0,0">
                                                    <Run Text="{Binding CurrentWeather.PrecipitationChance}"/>
                                                    <Run Text="%"/>
                                                </TextBlock>
                                            </StackPanel>
                                        </Border>

                                        <!-- UV指数 -->
                                        <Border Background="#1a1f3a" CornerRadius="15" Padding="20" Margin="5">
                                            <StackPanel>
                                                <TextBlock Text="☀️" FontSize="32"/>
                                                <TextBlock Text="UV指数" Foreground="#B0B0B0" FontSize="14" Margin="0,8,0,0"/>
                                                <TextBlock Text="{Binding CurrentWeather.UVIndex}" Foreground="White" FontSize="26" FontWeight="Bold" Margin="0,5,0,0"/>
                                            </StackPanel>
                                        </Border>
                                    </UniformGrid>
                                </Grid>
                            </Grid>
                        </Border>

                        <!-- 時間別予報 -->
                        <Border Style="{StaticResource GlassCard}" Padding="30" Margin="0,0,0,20">
                            <StackPanel>
                                <TextBlock Text="⏰ 時間別予報" FontSize="24" FontWeight="Bold" Foreground="White" Margin="0,0,0,20"/>

                                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled">
                                    <ItemsControl ItemsSource="{Binding HourlyForecasts}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <StackPanel Orientation="Horizontal"/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="#1a1f3a" CornerRadius="15" Padding="20" Margin="0,0,10,0" Width="100">
                                                    <StackPanel HorizontalAlignment="Center">
                                                        <TextBlock Text="{Binding Time}" Foreground="#B0B0B0" FontSize="14" HorizontalAlignment="Center"/>
                                                        <TextBlock Text="{Binding Icon}" FontSize="36" HorizontalAlignment="Center" Margin="0,10,0,10"/>
                                                        <TextBlock Foreground="White" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center">
                                                            <Run Text="{Binding Temperature}"/>
                                                            <Run Text="°"/>
                                                        </TextBlock>
                                                    </StackPanel>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>
                            </StackPanel>
                        </Border>

                        <!-- 週間天気予報 -->
                        <Border Style="{StaticResource GlassCard}" Padding="30">
                            <StackPanel>
                                <TextBlock Text="📅 週間天気予報" FontSize="24" FontWeight="Bold" Foreground="White" Margin="0,0,0,20"/>

                                <!-- 各日の予報 -->
                                <ItemsControl ItemsSource="{Binding WeeklyForecasts}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="#1a1f3a" CornerRadius="12" Padding="20" Margin="0,0,0,10">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="120"/>
                                                        <ColumnDefinition Width="60"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="120"/>
                                                    </Grid.ColumnDefinitions>

                                                    <TextBlock Grid.Column="0" Text="{Binding DayOfWeek}" Foreground="White" FontSize="18" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                                    <TextBlock Grid.Column="1" Text="{Binding Icon}" FontSize="32" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    <ProgressBar Grid.Column="2" Value="{Binding PrecipitationChance}" Maximum="100" Height="8" Background="#2a2f4a" 
                                                               Foreground="#667eea" VerticalAlignment="Center" Margin="20,0"/>
                                                    <TextBlock Grid.Column="3" Foreground="White" FontSize="18" FontWeight="Bold" VerticalAlignment="Center" HorizontalAlignment="Right">
                                                        <Run Text="{Binding HighTemp}"/>
                                                        <Run Text="° / "/>
                                                        <Run Text="{Binding LowTemp}"/>
                                                        <Run Text="°"/>
                                                    </TextBlock>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Border>

                    </StackPanel>
                </ScrollViewer>

            </Grid>
        </Grid>
    </Border>
</Window>